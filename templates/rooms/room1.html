{% extends "base.html" %}
{% block title %} Mozi {% endblock title %}
{% block content %}
<div class="sticky-top" style="padding:0 2%;">{% include "navbars/customer_navbar.html" %}</div>
<div class="room1">
    <button class="room1_vaszon" disabled>VÁSZON</button>
    <table>
        <tbody>
        {% for row in seat_data %}
            <tr>
                <td>{{ row.row }}</td>
                {% for seat in row.seats %}
                <td>
                    {% if seat.reserved %}
                        <!-- Lefoglalt szék -->
                        <button 
                            type="button" 
                            class="btn btn-danger" 
                            disabled>
                            {{ seat.number }}
                        </button>
                    {% else %}
                        <!-- Szabad szék -->
                        <button 
                            type="button" 
                            class="btn btn-success" 
                            hx-post="{% url 'customer:toggle_button' %}" 
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                            hx-vals='{"screening_id": "{{ screening.ID }}", "row_number": "{{ row.row }}", "seat_number": "{{ seat.number }}", "current_class": "btn btn-success"}'
                            hx-swap="outerHTML">
                            {{ seat.number }}
                        </button>
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <!-- Tovább gomb -->
    <a href="{% url 'customer:ticket_form' screening_id=screening.ID %}" class="btn btn-primary mt-3">Tovább</a>
</div>



{#<script>#}
{#let selectedSeats = [];#}
{##}
{#function toggleSeat(button) {#}
{#    const row = button.getAttribute("data-row");#}
{#    const seat = button.getAttribute("data-seat");#}
{#    const index = selectedSeats.findIndex(s => s.row === row && s.seat === seat);#}
{#    if (index === -1) {#}
{#        selectedSeats.push({ row, seat });#}
{#        button.classList.remove("btn-success");#}
{#        button.classList.add("btn-warning");#}
{#    } else {#}
{#        selectedSeats.splice(index, 1);#}
{#        button.classList.remove("btn-warning");#}
{#        button.classList.add("btn-success");#}
{#    }#}
{##}
{#    console.log("Kiválasztott székek:", selectedSeats);#}
{#}#}
{##}
{#document.getElementById("booking-form").addEventListener("submit", function(event) {#}
{#    const hiddenInput = document.getElementById("selected-seats");#}
{#    hiddenInput.value = JSON.stringify(selectedSeats); // A székeket JSON formátumba konvertáljuk#}
{#    console.log("Küldött adatok:", hiddenInput.value);#}
{#});#}
{#</script>#}
{% endblock content %}
